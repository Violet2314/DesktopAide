# 飞书导出功能使用指南

## 🎉 功能已成功集成！

恭喜！飞书多维表格导出功能已经成功集成到您的DesktopAide应用中。

## 📋 功能概述

### ✨ 主要功能
- **应用使用数据导出** - 详细的应用使用记录
- **工作模式会话导出** - 专注时长和分心时长统计  
- **汇总数据导出** - 基于应用使用的汇总统计
- **历史数据导出** - 支持7天/30天历史数据批量导出
- **自动定时导出** - 可设置导出间隔（小时）

### 🎨 用户界面特性
- 现代化玻璃态设计
- 直观的配置界面
- 实时状态反馈
- 详细的导出结果显示

## 🚀 快速开始

### 1. 访问数据导出页面
在应用的侧边栏中，点击 **"数据导出"** 菜单项（云上传图标）

### 2. 配置飞书应用信息
在"飞书配置"区域填入以下信息：

#### 必需配置项：
- **应用ID** - 飞书开放平台应用的App ID
- **应用密钥** - 飞书开放平台应用的App Secret  
- **多维表格Token** - 目标多维表格的App Token
- **应用详细数据表ID** - 存储应用使用详细数据的表格ID
- **汇总数据表ID** - 存储汇总统计数据的表格ID
- **块类型ID** - 多维表格的Block Type ID

### 3. 测试连接
点击 **"测试连接"** 按钮验证配置是否正确

### 4. 开始导出数据
配置成功后，您可以：
- 导出今日数据
- 导出历史数据（7天或30天）
- 导出汇总数据
- 设置自动导出

## 📊 数据格式说明

### 应用详细数据表字段
| 字段名 | 类型 | 说明 |
|--------|------|------|
| 应用名称 | 文本 | 应用程序名称 |
| 使用时长 | 数字 | 使用时长（小时） |
| 日期 | 数字 | 日期时间戳 |
| 占比 | 数字 | 在总时长中的占比 |

### 汇总数据表字段
| 字段名 | 类型 | 说明 |
|--------|------|------|
| 总时长 | 数字 | 总使用时长（小时） |
| 专注时长 | 数字 | 高效应用使用时长（小时） |
| 分心时长 | 数字 | 分心应用使用时长（小时） |
| 效率得分 | 数字 | 效率得分（0-1之间的小数） |

## ⚙️ 飞书应用配置步骤

### 1. 创建飞书应用
1. 访问 [飞书开放平台](https://open.feishu.cn/)
2. 创建企业自建应用
3. 获取 App ID 和 App Secret

### 2. 创建多维表格
1. 在飞书中创建多维表格
2. 创建两个数据表：
   - **应用详细数据表** - 包含上述应用详细数据字段
   - **汇总数据表** - 包含上述汇总数据字段

### 3. 获取权限
确保应用具有以下权限：
- `bitable:app` - 多维表格应用权限
- `bitable:app:readonly` - 多维表格读取权限  
- `bitable:app:readwrite` - 多维表格读写权限

### 4. 获取配置信息
- **App Token** - 在多维表格设置中获取
- **Table ID** - 在数据表URL中获取
- **Block Type ID** - 通过API获取或在开发者工具中查看

## 🔧 自动导出设置

### 启用自动导出
1. 在"自动导出设置"区域
2. 设置导出间隔（1-168小时）
3. 点击"启用自动导出"

### 监控自动导出
- 查看自动导出状态（已启用/已禁用）
- 查看导出间隔设置
- 查看上次导出时间

## 📈 使用建议

### 数据分析
- 定期导出数据进行长期趋势分析
- 使用飞书的图表功能创建可视化报告
- 设置合适的自动导出间隔（建议24小时）

### 效率优化
- 关注效率得分变化趋势
- 分析专注时长和分心时长的比例
- 根据数据调整工作习惯

## 🔍 故障排查

### 常见问题

#### 1. 连接失败
- 检查网络连接
- 验证飞书应用配置信息
- 确认应用权限设置

#### 2. 导出失败  
- 检查数据表字段是否匹配
- 验证表格ID是否正确
- 查看错误日志信息

#### 3. 自动导出不工作
- 确认自动导出已启用
- 检查导出间隔设置
- 验证应用运行状态

### 调试信息
在开发者工具的控制台中可以查看详细的调试信息和错误日志。

## 🎯 测试结果

✅ **集成测试通过**
- 数据格式化逻辑正确
- 效率统计计算准确
- 应用记录格式符合预期
- 汇总数据格式正确

### 测试数据示例
```
总时长: 8.00 小时
专注时长: 7.00 小时  
分心时长: 1.00 小时
效率得分: 87.5%
```

## 📞 技术支持

如果在使用过程中遇到问题：
1. 查看控制台错误日志
2. 检查飞书应用配置
3. 验证网络连接状态
4. 参考飞书开放平台文档

## 🎊 开始使用

现在您可以：
1. 打开应用并导航到"数据导出"页面
2. 配置您的飞书应用信息
3. 测试连接并开始导出数据
4. 在飞书中查看和分析您的使用数据

**祝您使用愉快！** 🚀
