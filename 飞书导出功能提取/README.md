# 🚀 飞书多维表格导出功能包

## 📖 简介

这是一个完整的飞书多维表格数据导出功能包，从DesktopAide项目中提取而来。该功能包提供了将应用使用数据和工作模式会话数据导出到飞书多维表格的完整解决方案。

## ✨ 功能特性

### 🔄 数据导出类型
- **应用使用数据导出** - 详细的应用使用记录
- **工作模式会话导出** - 专注时长和分心时长统计
- **汇总数据导出** - 基于应用使用的汇总统计
- **历史数据导出** - 支持7天/30天历史数据批量导出

### ⚡ 自动化功能
- **定时自动导出** - 可设置导出间隔（小时）
- **批量数据处理** - 自动分批处理大量数据
- **访问令牌管理** - 自动获取和刷新访问令牌
- **错误处理重试** - 智能错误处理和重试机制

### 🎨 用户界面
- **现代化设计** - 玻璃态视觉效果
- **直观操作** - 一键导出和配置
- **实时反馈** - 导出进度和结果显示
- **响应式布局** - 适配不同屏幕尺寸

## 📁 包含内容

### 核心代码文件
- `FeishuService.ts` - 飞书API集成服务
- `DataExportManager.ts` - 数据导出管理器
- `DataExport.tsx` - 前端页面组件
- `DataExport.css` - 页面样式文件
- `electron.d.ts` - TypeScript类型定义

### 测试验证文件
- `test_feishu_export.js` - 主要功能测试
- `test_app_usage_summary.js` - 汇总数据测试
- `verify_table_ids.js` - 表格配置验证
- 其他专项测试脚本

### 完整文档
- `FEISHU_EXPORT_SUCCESS.md` - 功能实现报告
- `SUMMARY_EXPORT_GUIDE_FINAL.md` - 使用指南
- `FEISHU_EXPORT_GUIDE.md` - 配置说明
- 其他技术文档

## 🚀 快速开始

### 1. 查看集成指南
```bash
# 阅读集成指南
cat 集成指南.md
```

### 2. 复制核心文件
将`核心服务文件/`目录下的文件复制到你的项目中

### 3. 安装依赖
```bash
npm install axios @fortawesome/react-fontawesome @fortawesome/free-solid-svg-icons
```

### 4. 配置飞书应用
在飞书开放平台创建应用并获取配置信息

### 5. 运行测试
```bash
node 测试文件/test_feishu_export.js
```

## 📊 数据格式

### 应用详细数据
```json
{
  "应用名称": "Chrome",
  "使用时长": 2.5,
  "日期": 1735142400000,
  "占比": 0.3
}
```

### 汇总数据
```json
{
  "总时长": 8.5,
  "专注时长": 6.8,
  "分心时长": 1.7,
  "效率得分": 0.8
}
```

## 🔧 技术栈

- **后端**: Node.js + TypeScript + Electron
- **前端**: React + TypeScript + CSS
- **API**: 飞书开放平台API
- **数据处理**: Axios + 异步处理
- **UI**: FontAwesome + 玻璃态设计

## 📋 系统要求

- Node.js 16+
- TypeScript 4.5+
- React 18+
- Electron 20+

## 🎯 使用场景

### 个人用户
- 追踪个人应用使用情况
- 分析工作效率和专注度
- 导出数据进行个人分析

### 团队协作
- 团队成员使用数据共享
- 工作效率统计和对比
- 项目时间分配分析

### 数据分析
- 在飞书中创建图表和报告
- 长期趋势分析
- 效率优化建议

## 📈 功能优势

### 🔒 数据安全
- 本地配置存储
- HTTPS安全传输
- 敏感信息加密

### ⚡ 高性能
- 批量数据处理
- 异步操作优化
- 智能缓存机制

### 🎨 用户体验
- 直观的操作界面
- 实时状态反馈
- 详细的错误提示

### 🔧 可维护性
- TypeScript类型安全
- 模块化架构设计
- 完整的测试覆盖

## 📞 支持与反馈

### 文档资源
- 查看`文档文件/`目录下的完整文档
- 参考`集成指南.md`进行集成
- 使用测试脚本验证功能

### 常见问题
1. **连接失败** - 检查网络和配置
2. **导出失败** - 验证数据格式和权限
3. **自动导出不工作** - 确认设置和应用状态

### 调试工具
- 使用提供的测试脚本
- 查看控制台错误日志
- 参考调试文档

## 🎉 版本信息

- **版本**: v1.0.0
- **发布日期**: 2024年12月
- **兼容性**: 完全测试通过
- **状态**: 生产就绪

## 📄 许可证

本功能包遵循原项目的许可证条款。

---

## 🌟 开始使用

1. **阅读文档** - 从`集成指南.md`开始
2. **运行测试** - 验证功能完整性
3. **集成代码** - 按照指南集成到你的项目
4. **配置飞书** - 设置飞书应用和表格
5. **开始导出** - 享受自动化数据导出功能

**祝你使用愉快！** 🎊