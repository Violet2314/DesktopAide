# 📊 飞书多维表格数据格式修正说明

## ✅ 修正后的数据格式

根据您的要求，已将数据格式修正为：

### 标准JSON格式
```json
{
  "records": [
    {
      "fields": {
        "应用名称": "Chrome",
        "使用时长": 2.5,
        "日期": 1735142400000,
        "占比": 0.3
      }
    },
    {
      "fields": {
        "应用名称": "VSCode", 
        "使用时长": 1.8,
        "日期": 1735142400000,
        "占比": 0.25
      }
    }
  ]
}
```

### 字段说明

#### 1. 应用名称
- **类型**: 字符串
- **说明**: 应用程序名称
- **示例**: "Chrome", "VSCode", "微信"

#### 2. 使用时长
- **类型**: 数字（浮点数）
- **单位**: 小时
- **说明**: 应用的使用时长，以小时为单位
- **示例**: 
  - `1.5` = 1小时30分钟
  - `0.25` = 15分钟
  - `2.75` = 2小时45分钟

#### 3. 日期
- **类型**: 数字（长整型）
- **单位**: 毫秒
- **说明**: 毫秒级时间戳
- **示例**: `1735142400000` = 2024年12月26日

#### 4. 占比
- **类型**: 数字（浮点数）
- **格式**: 小数形式
- **说明**: 该应用占当天总使用时间的比例
- **示例**:
  - `0.3` = 30%
  - `0.15` = 15%
  - `0.05` = 5%

## 🔧 修正的内容

### 原格式问题
- ❌ 使用时长单位为毫秒
- ❌ 占比使用百分比数值（如30表示30%）

### 修正后格式
- ✅ 使用时长单位为小时
- ✅ 占比使用小数形式（如0.3表示30%）

## 📝 实际导出示例

### 应用使用数据示例
```json
{
  "records": [
    {
      "fields": {
        "应用名称": "总计",
        "使用时长": 8.5,
        "日期": 1735142400000,
        "占比": 1.0
      }
    },
    {
      "fields": {
        "应用名称": "Chrome",
        "使用时长": 3.2,
        "日期": 1735142400000,
        "占比": 0.376
      }
    },
    {
      "fields": {
        "应用名称": "VSCode",
        "使用时长": 2.8,
        "日期": 1735142400000,
        "占比": 0.329
      }
    },
    {
      "fields": {
        "应用名称": "微信",
        "使用时长": 1.5,
        "日期": 1735142400000,
        "占比": 0.176
      }
    }
  ]
}
```

### 工作模式会话数据示例
```json
{
  "records": [
    {
      "fields": {
        "应用名称": "工作会话-深度工作模式",
        "使用时长": 4.5,
        "日期": 1735142400000,
        "占比": 0.85
      }
    }
  ]
}
```

## 🧮 数据转换逻辑

### 时长转换
```javascript
// 毫秒转小时
const hours = milliseconds / (1000 * 60 * 60)

// 示例：
// 5400000毫秒 = 1.5小时
// 3600000毫秒 = 1.0小时
// 1800000毫秒 = 0.5小时
```

### 占比计算
```javascript
// 计算占比（小数形式）
const ratio = appDuration / totalDuration

// 示例：
// 应用使用2小时，总计8小时 = 0.25
// 应用使用3小时，总计10小时 = 0.3
// 专注时长4小时，总时长5小时 = 0.8
```

### 时间戳转换
```javascript
// 日期字符串转毫秒时间戳
const timestamp = new Date(dateString).getTime()

// 示例：
// "2024-12-26" → 1735142400000
```

## ✅ 验证测试

### 测试数据
已通过以下测试数据验证格式正确性：

```json
{
  "fields": {
    "应用名称": "测试应用",
    "使用时长": 1.5,
    "日期": 1735142400000,
    "占比": 0.3
  }
}
```

### 测试结果
- ✅ API调用成功
- ✅ 记录创建成功
- ✅ 数据格式正确
- ✅ 飞书表格显示正常

## 📊 飞书表格中的显示

在飞书多维表格中，数据将显示为：

| 应用名称 | 使用时长 | 日期 | 占比 |
|---------|---------|------|------|
| Chrome | 3.2 | 1735142400000 | 0.376 |
| VSCode | 2.8 | 1735142400000 | 0.329 |
| 微信 | 1.5 | 1735142400000 | 0.176 |

### 理解数据
- **Chrome**: 使用了3.2小时，占当天总使用时间的37.6%
- **VSCode**: 使用了2.8小时，占当天总使用时间的32.9%
- **微信**: 使用了1.5小时，占当天总使用时间的17.6%

## 🎯 使用建议

### 数据分析
1. **时长分析**: 直接查看小时数，便于理解
2. **占比分析**: 小数形式便于计算和比较
3. **趋势分析**: 时间戳便于按日期排序和筛选

### 可视化
- 使用占比数据创建饼图
- 使用时长数据创建柱状图
- 使用时间戳数据创建时间序列图

## 🔄 更新说明

### v1.1.0 (当前版本)
- ✅ 修正使用时长单位为小时
- ✅ 修正占比格式为小数形式
- ✅ 保持日期为毫秒级时间戳
- ✅ 简化字段结构，专注核心数据

### 兼容性
- 新格式与飞书多维表格完全兼容
- 数据更易于理解和分析
- 符合国际标准的数据格式规范
