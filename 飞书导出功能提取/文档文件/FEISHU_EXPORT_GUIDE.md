# 飞书多维表格数据导出功能使用指南

## 功能概述

本功能允许将应用使用数据和工作模式会话数据导出到飞书多维表格中，方便进行数据分析和团队协作。

## 预配置信息

系统已预配置以下飞书应用信息：
- **App ID**: cli_a808ad9d0878d00c
- **App Secret**: RWK6uKuO6yNjpVq0IMcdVcyGFgJ5DAKg
- **App Token**: wuvsbjMugavijdsKwlpcgQ0InUv
- **Table ID**: tblIcuV8Fz6JuQ7J
- **Block Type ID**: blk_68821180a94000030d5cde2e

## 使用步骤

### 1. 配置飞书连接

1. 打开应用，点击左侧导航栏的"数据导出"
2. 在飞书配置区域，系统已预填写配置信息
3. 点击"测试连接"按钮验证配置是否正确
4. 如果连接成功，会显示绿色的成功提示

### 2. 导出数据

#### 手动导出
- **导出今日数据**: 点击"导出今日数据"按钮
- **导出历史数据**: 
  - 点击"导出近7天数据"导出最近一周的数据
  - 点击"导出近30天数据"导出最近一个月的数据

#### 从应用追踪页面导出
- 在应用追踪页面，点击右上角的"导出到飞书"按钮
- 如果选择了特定日期，将导出该日期的数据
- 如果未选择日期，将导出今日数据

#### 自动导出
1. 在数据导出页面的"自动导出设置"区域
2. 设置导出间隔（小时），默认为24小时
3. 点击"启用自动导出"按钮
4. 系统将按设定间隔自动导出今日数据

### 3. 查看导出结果

导出完成后，页面会显示导出结果：
- **成功**: 显示绿色成功提示和详细统计
- **失败**: 显示红色错误提示和失败原因

## 导出数据结构

### 应用使用数据记录
每条应用使用记录包含以下字段：
- **应用名称**: 应用程序名称
- **使用时长**: 使用时长（小时为单位，如1.5表示1.5小时）
- **日期**: 毫秒级时间戳
- **占比**: 该应用占总使用时间的比例（小数形式，如0.3表示30%）

### 工作模式会话记录
每条工作会话记录包含以下字段：
- **应用名称**: 工作会话标识（如"工作会话-深度工作模式"）
- **使用时长**: 总工作时长（小时为单位）
- **日期**: 会话开始时间的毫秒级时间戳
- **占比**: 专注率（小数形式，如0.8表示80%的专注率）

## 功能特点

### 🔄 自动化
- 支持自动定时导出
- 可自定义导出间隔
- 自动处理访问令牌刷新

### 📊 数据完整性
- 导出应用使用详细数据
- 导出工作模式会话数据
- 包含汇总和明细记录

### 🛡️ 错误处理
- 连接测试功能
- 详细的错误提示
- 批量导出失败重试

### 📱 用户友好
- 直观的配置界面
- 实时导出状态显示
- 详细的导出结果反馈

## 注意事项

### 权限要求
- 确保飞书应用有多维表格的写入权限
- 确保表格ID和应用Token正确匹配

### 数据限制
- 单次最多导出500条记录（系统自动分批处理）
- 历史数据最多保留30天的会话记录

### 网络要求
- 需要稳定的网络连接
- 导出大量数据时可能需要较长时间

### 数据安全
- 所有配置信息本地存储
- 支持密码字段隐藏显示
- 传输过程使用HTTPS加密

## 故障排查

### 连接失败
1. 检查网络连接
2. 验证App ID和App Secret是否正确
3. 确认App Token和Table ID是否有效
4. 检查飞书应用权限设置

### 导出失败
1. 检查表格是否存在
2. 验证应用是否有写入权限
3. 确认数据格式是否正确
4. 查看详细错误信息

### 自动导出不工作
1. 确认自动导出已启用
2. 检查导出间隔设置
3. 查看应用是否正常运行
4. 检查系统时间是否正确

## 技术支持

如遇到问题，请检查：
1. 控制台错误日志
2. 网络连接状态
3. 飞书应用配置
4. 表格权限设置

## 更新日志

### v1.0.0
- 初始版本发布
- 支持应用使用数据导出
- 支持工作模式会话数据导出
- 支持自动定时导出
- 支持批量数据处理
